<script>
        const viraId = Math.random().toString(36).substring(2, 10);
        const basePath = "/VORA/VERN_SYSTEM/uv/";
        self.__uv$config = {
            prefix: basePath + "service/",
            encodeUrl: Ultraviolet.codec.xor.encode,
            decodeUrl: Ultraviolet.codec.xor.decode,
            handler: basePath + "uv.handler.js",
            client: basePath + "uv.client.js",
            bundle: basePath + "uv.bundle.js",
            config: basePath + "uv.config.js",
            sw: basePath + "uv.sw.js",
            stockSW: "/VORA/VERN_SYSTEM/sw.js",
            bare: "/api/bare?v=" + viraId,
        };
    </script>
    <script src="/VORA/VERN_SYSTEM/baremux/index.js"></script>
    <script>
        window.checkBare = async () => {
            const connection = new BareMux.BareMuxConnection("/VORA/VERN_SYSTEM/baremux/worker.js");
            const wispUrl = "wss://wisp.mercurywork.shop/";
            const transportPath = "/VORA/VERN_SYSTEM/libcurl/index.mjs";
            
            try {
                const transport = await connection.getTransport();
                if (!transport || transport.path !== transportPath) {
                    await connection.setTransport(transportPath, [{ websocket: wispUrl }]);
                }
            } catch (e) {
                await connection.setTransport(transportPath, [{ websocket: wispUrl }]);
            }
        };

        (async () => {
            if ("serviceWorker" in navigator) {
                try {
                    // Use the viraId to force a service worker update on refresh
                    await navigator.serviceWorker.register("/VORA/VERN_SYSTEM/sw.js?v=" + viraId, {
                        scope: "/VORA/VERN_SYSTEM/"
                    });
                } catch (e) { console.error("VERN Proxy Error", e); }
            }
            await window.checkBare();
        })();
    </script>